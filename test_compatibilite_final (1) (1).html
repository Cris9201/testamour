<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Test de Compatibilit√© Amoureuse Moderne</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
    min-height: 100vh;
    margin: 0;
    font-family: 'Montserrat', Arial, sans-serif;
    background: #111;
    color: #fff;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    }
    .container {
    width: 100vw;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    }
    .glass {
    background: rgba(255,255,255,0.10);
    border-radius: 22px;
    box-shadow: 0 8px 32px 0 rgba(31,38,135,0.37);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1.5px solid rgba(255,255,255,0.18);
    padding: 38px 24px 32px 24px;
    margin: 24px 0;
    max-width: 480px;
    width: 95vw;
    box-sizing: border-box;
    }
    .start-screen, .names-screen, .question-card, .email-screen, .result-card {
    width: 100%;
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    animation: fadeIn 0.5s;
    }
    .active { display: flex; }
    .question-title {
    font-size: 1.5em;
    font-weight: 700;
    margin-bottom: 32px;
    text-align: center;
    color: #fff;
    letter-spacing: 0.01em;
    }
    .progress-bar {
    width: 100%;
    height: 5px;
    background: #232323;
    border-radius: 3px;
    margin-bottom: 24px;
    overflow: hidden;
    box-shadow: 0 1px 8px 0 rgba(255,0,80,0.08);
    }
    .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #ff3576 0%, #ff8fa3 100%);
    transition: width 0.3s cubic-bezier(.4,2,.6,1);
    border-radius: 3px;
    }
    .options {
    display: flex;
    flex-direction: column;
    gap: 18px;
    margin-top: 18px;
    align-items: center;
    }
    .option-btn {
    background: linear-gradient(90deg, #ff3576 0%, #ff8fa3 100%);
    border: none;
    border-radius: 18px;
    padding: 15px 32px;
    font-size: 1.08em;
    color: #fff;
    font-family: 'Montserrat', Arial, sans-serif;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.18s cubic-bezier(.4,2,.6,1);
    box-shadow: 0 2px 12px 0 rgba(255,53,118,0.10);
    letter-spacing: 0.01em;
    outline: none;
    min-width: 220px;
    max-width: 90vw;
    word-break: break-word;
    }
    .option-btn:hover, .option-btn.selected {
    background: linear-gradient(90deg, #ff8fa3 0%, #ff3576 100%);
    color: #fff;
    transform: scale(1.04);
    box-shadow: 0 4px 18px 0 rgba(255,53,118,0.18);
    }
    .astrology-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    width: 100%;
    max-width: 450px;
    margin: 0 auto;
    }
    .astrology-grid .option-btn {
    min-width: 140px;
    margin-bottom: 8px;
    padding: 16px 12px;
    font-size: 1.05em;
    line-height: 1.3;
    }
    .result-card {
    text-align: center;
    padding: 30px 0;
    max-width: 1100px;
    background: none;
    box-shadow: none;
    }
    .result-score {
    font-size: 2.5em;
    margin: 18px 0 10px 0;
    font-weight: bold;
    color: #ff3576;
    text-shadow: 0 2px 12px rgba(255,53,118,0.10);
    }
    .charts-container {
    display: flex;
    flex-direction: row;
    gap: 30px;
    margin: 24px 0 0 0;
    width: 100%;
    justify-content: center;
    align-items: flex-start;
    }
    .chart-wrapper {
    background: #000;
    padding: 15px 8px 8px 8px;
    border-radius: 15px;
    backdrop-filter: blur(10px);
    width: 380px;
    min-width: 280px;
    max-width: 100vw;
    height: 250px;
    box-sizing: border-box;
    margin-bottom: 0;
    border: 1px solid rgba(255,255,255,0.1);
    overflow: hidden;
    }
    .chart-title {
    font-size: 1.05em;
    font-weight: bold;
    margin-bottom: 6px;
    color: #fff;
    text-align: center;
    }
    .chart-canvas {
    width: 100% !important;
    height: 200px !important;
    max-height: 200px !important;
    }
    .analysis-section {
    background: rgba(255,255,255,0.10);
    padding: 22px;
    border-radius: 15px;
    backdrop-filter: blur(10px);
    margin: 18px 0;
    text-align: left;
    color: #fff;
    }
    .analysis-title {
    font-size: 1.18em;
    font-weight: bold;
    color: #ff3576;
    margin-bottom: 8px;
    }
    .analysis-text {
    font-size: 1.01em;
    line-height: 1.6;
    margin-bottom: 8px;
    }
    .theme-analysis {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 12px;
    margin: 18px 0;
    }
    .theme-card {
    background: rgba(255,255,255,0.10);
    padding: 13px;
    border-radius: 10px;
    backdrop-filter: blur(10px);
    color: #fff;
    }
    .theme-name {
    font-weight: bold;
    margin-bottom: 5px;
    color: #ff3576;
    font-size: 1.05em;
    }
    .theme-score {
    font-size: 1.18em;
    font-weight: bold;
    margin-bottom: 5px;
    }
    .theme-text {
    font-size: 0.97em;
    line-height: 1.4;
    }
    .restart-btn {
    background: linear-gradient(90deg, #ff3576 0%, #ff8fa3 100%);
    color: #fff;
    border: none;
    border-radius: 25px;
    padding: 12px 30px;
    font-size: 1em;
    font-weight: bold;
    cursor: pointer;
    margin: 18px;
    transition: all 0.2s;
    box-shadow: 0 3px 12px rgba(255,53,118,0.10);
    }
    .restart-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(255,53,118,0.18);
    }
    .names-form {
    display: flex;
    flex-direction: column;
    gap: 22px;
    align-items: center;
    background: none;
    padding: 0;
    border-radius: 15px;
    }
    .names-form input {
    padding: 13px 18px;
    border-radius: 10px;
    border: 2px solid rgba(255,255,255,0.18);
    background: rgba(255,255,255,0.08);
    color: #fff;
    font-size: 1.08em;
    width: 220px;
    text-align: center;
    font-family: 'Montserrat', Arial, sans-serif;
    }
    .names-form input::placeholder {
    color: rgba(255,255,255,0.7);
    }
    .names-form input:focus {
    outline: none;
    border-color: #ff3576;
    }

    /* Styles pour l'√©cran de collecte d'email */
    .email-screen {
    text-align: center;
    }
    .email-title {
    font-size: 1.8em;
    font-weight: 700;
    margin-bottom: 18px;
    color: #ff3576;
    letter-spacing: 0.01em;
    }
    .email-subtitle {
    font-size: 1.1em;
    margin-bottom: 24px;
    color: #fff;
    line-height: 1.5;
    }
    .email-form {
    display: flex;
    flex-direction: column;
    gap: 20px;
    align-items: center;
    }
    .email-input {
    padding: 15px 20px;
    border-radius: 12px;
    border: 2px solid rgba(255,255,255,0.18);
    background: rgba(255,255,255,0.08);
    color: #fff;
    font-size: 1.1em;
    width: 280px;
    max-width: 90vw;
    text-align: center;
    font-family: 'Montserrat', Arial, sans-serif;
    box-sizing: border-box;
    }
    .email-input::placeholder {
    color: rgba(255,255,255,0.7);
    }
    .email-input:focus {
    outline: none;
    border-color: #ff3576;
    box-shadow: 0 0 15px rgba(255,53,118,0.3);
    }
    .email-btn {
    background: linear-gradient(90deg, #ff3576 0%, #ff8fa3 100%);
    color: #fff;
    border: none;
    border-radius: 25px;
    padding: 15px 35px;
    font-size: 1.1em;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: 0 3px 12px rgba(255,53,118,0.10);
    font-family: 'Montserrat', Arial, sans-serif;
    }
    .email-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(255,53,118,0.18);
    }
    .email-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
    }
    .email-message {
    font-size: 0.95em;
    color: rgba(255,255,255,0.8);
    margin-top: 15px;
    line-height: 1.4;
    }
    .error-message {
    color: #ff6b6b;
    font-size: 0.9em;
    margin-top: 10px;
    }
    .success-message {
    color: #51cf66;
    font-size: 0.9em;
    margin-top: 10px;
    }

    @media (max-width: 768px) {
    .glass { padding: 18px 4vw 18px 4vw; }
    .question-title { font-size: 1.1em; }
    .chart-wrapper { width: 100%; min-width: 0; height: 200px; }
    .chart-canvas { height: 150px !important; max-height: 150px !important; }
    .astrology-grid { grid-template-columns: 1fr; gap: 10px; }
    .astrology-grid .option-btn { min-width: 120px; }
    .charts-container { flex-direction: column; gap: 20px; }
    .theme-analysis { grid-template-columns: 1fr; }
    .email-title { font-size: 1.5em; }
    .email-input { width: 250px; }
    .result-card { padding: 20px 0; }
    }
    @keyframes fadeIn {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="glass start-screen active" id="startScreen">
    <h1 style="font-size: 2em; margin-bottom: 18px; color:#ff3576; font-weight:700; letter-spacing:0.01em; text-align:center;">üíï Test de Compatibilit√©<br>Amoureuse</h1>
    <p style="font-size: 1.08em; margin-bottom: 32px; text-align: center; color:#fff;">D√©couvrez votre compatibilit√© √† travers une analyse moderne et √©l√©gante</p>
    <button class="restart-btn" onclick="showNamesScreen()">Commencer le test</button>
    </div>

    <div class="glass names-screen" id="namesScreen">
    <h2 style="font-size: 1.3em; margin-bottom: 18px; color:#ff3576; font-weight:700;">Entrez vos pr√©noms</h2>
    <div class="names-form">
    <input type="text" id="prenom1" placeholder="Pr√©nom Personne 1" required maxlength="20">
    <input type="text" id="prenom2" placeholder="Pr√©nom Personne 2" required maxlength="20">
    <button class="restart-btn" onclick="startTest()">Lancer le test</button>
    </div>
    </div>

    <div class="glass question-card" id="questionCard">
    <div class="progress-bar">
    <div class="progress-fill" id="progressFill"></div>
    </div>
    <div class="question-title" id="questionTitle"></div>
    <div class="options" id="options"></div>
    </div>

    <!-- Nouvel √©cran de collecte d'email -->
    <div class="glass email-screen" id="emailScreen">
    <div class="email-title">üéâ Test termin√© !</div>
    <div class="email-subtitle">
        D√©couvre ton score de compatibilit√© et re√ßois des conseils personnalis√©s pour booster ta vie amoureuse ! Entre ton email pour acc√©der √† tes r√©sultats exclusifs.
    </div>
    <div class="email-form">
        <input type="email" id="emailInput" class="email-input" placeholder="Votre adresse email" required>
        <button class="email-btn" id="emailBtn" onclick="submitEmail()">Voir mes r√©sultats üíï</button>
        <div id="emailMessage" class="email-message"></div>
    </div>
    <div class="email-message">
        ‚ú® Analyse personnalis√©e ‚Ä¢ Conseils d'experts ‚Ä¢ 100% gratuit
    </div>
    </div>

    <div class="result-card" id="resultCard">
    <div class="glass" style="margin:0 auto;max-width:800px;">
    <h2 style="font-size: 1.2em; margin-bottom: 12px; color:#ff3576; font-weight:700;">R√©sultat de Compatibilit√©</h2>
    <div class="result-score" id="resultScore"></div>
    <div class="charts-container">
    <div class="chart-wrapper">
    <div class="chart-title">Compatibilit√© Globale</div>
    <canvas id="globalChart" class="chart-canvas"></canvas>
    </div>
    <div class="chart-wrapper">
    <div class="chart-title">Compatibilit√© par Axe</div>
    <canvas id="themesChart" class="chart-canvas"></canvas>
    </div>
    </div>
    <div class="analysis-section">
    <div class="analysis-title">Analyse G√©n√©rale</div>
    <div class="analysis-text" id="globalAnalysis"></div>
    </div>
    <div class="theme-analysis" id="themeAnalysis"></div>
    <button class="restart-btn" onclick="location.reload()">Recommencer</button>
    </div>
    </div>
  </div>

  <script>
    // Regroupement des th√®mes en 6 axes principaux avec noms raccourcis
    const themeMap = {
    'Communication': 'Communication',
    'Affection': 'Communication',
    'Humour': 'Communication',
    'Jalousie': 'Valeurs',
    'Valeurs': 'Valeurs',
    'Avenir': 'Valeurs',
    'Intimit√©': 'Intimit√©',
    'Intimit√© Avanc√©e': 'Intimit√©',
    'Attraction': 'Intimit√©',
    'Lifestyle': 'Lifestyle',
    'Personnalit√©': 'Lifestyle',
    'Argent': 'Argent',
    'Astrologie': 'Astrologie'
    };

    // Noms raccourcis pour l'affichage dans le graphique
    const axes = [
    'Communication',
    'Intimit√©',
    'Valeurs',
    'Lifestyle',
    'Argent',
    'Astrologie'
    ];

    // Mapping pour les analyses d√©taill√©es (noms complets)
    const axesFullNames = {
    'Communication': 'Communication & Affection',
    'Intimit√©': 'Intimit√© & Fantasmes',
    'Valeurs': 'Valeurs & Projets',
    'Lifestyle': 'Lifestyle & Personnalit√©',
    'Argent': 'Argent & Gestion',
    'Astrologie': 'Astrologie'
    };

    // Questions compl√®tes avec signes astrologiques am√©lior√©s
    const questions = [
    // Questions sur les signes astrologiques - AM√âLIOR√âES
    {
    text: "{prenom1}, quel est votre signe astrologique ?",
    options: [
    ["B√©lier", "Taureau", "G√©meaux", "Cancer", "Lion", "Vierge"],
    ["Balance", "Scorpion", "Sagittaire", "Capricorne", "Verseau", "Poissons"]
    ],
    theme: 'Astrologie',
    person: 1
    },
    {
    text: "{prenom2}, quel est votre signe astrologique ?",
    options: [
    ["B√©lier", "Taureau", "G√©meaux", "Cancer", "Lion", "Vierge"],
    ["Balance", "Scorpion", "Sagittaire", "Capricorne", "Verseau", "Poissons"]
    ],
    theme: 'Astrologie',
    person: 2
    },

    // Questions altern√©es
    {
    text: "{prenom1}, quel √©l√©ment vous semble le plus en r√©sonance avec votre personnalit√© ?",
    options: ["Feu (passionn√©, √©nergique)", "Terre (stable, pratique)", "Air (curieux, communicatif)", "Eau (√©motionnel, intuitif)"],
    theme: 'Personnalit√©',
    person: 1
    },
    {
    text: "{prenom2}, combien de temps vous faut-il pour surmonter une d√©ception ?",
    options: ["Quelques heures", "Quelques jours", "Quelques semaines", "Plusieurs mois"],
    theme: 'Personnalit√©',
    person: 2
    },
    {
    text: "{prenom1}, √™tes-vous du genre √† pardonner facilement ?",
    options: ["Oui, tr√®s facilement", "Oui, mais √ßa prend du temps", "Non, difficilement", "Non, jamais"],
    theme: 'Communication',
    person: 1
    },
    {
    text: "{prenom2}, quel est votre type d'humour pr√©f√©r√© ?",
    options: ["Humour noir", "Humour absurde", "Humour sarcastique", "Humour l√©ger et bon enfant"],
    theme: 'Humour',
    person: 2
    },
    {
    text: "{prenom1}, avez-vous un sens de l'humour sarcastique ?",
    options: ["Oui", "Non"],
    theme: 'Humour',
    person: 1
    },
    {
    text: "{prenom2}, qu'est-ce qui d√©clenche le plus votre jalousie ?",
    options: ["L'attention de mon partenaire envers d'autres", "Le manque de communication", "Les secrets", "L'infid√©lit√©"],
    theme: 'Jalousie',
    person: 2
    },
    {
    text: "{prenom1}, √™tes-vous une personne jalouse ?",
    options: ["Tr√®s jalouse", "Un peu jalouse", "Rarement jalouse", "Pas du tout jalouse"],
    theme: 'Jalousie',
    person: 1
    },
    {
    text: "{prenom2}, quel est votre endroit pr√©f√©r√© pour √™tre embrass√©(e) ?",
    options: ["Cou", "L√®vres", "Dos", "Partout"],
    theme: 'Intimit√©',
    person: 2
    },
    {
    text: "{prenom1}, aimez-vous sortir souvent ?",
    options: ["Oui, tr√®s souvent", "Oui, de temps en temps", "Non, rarement", "Non, jamais"],
    theme: 'Lifestyle',
    person: 1
    },
    {
    text: "{prenom2}, quelle est votre attitude face √† l'argent ?",
    options: ["Je d√©pense sans compter", "J'√©conomise pour l'avenir", "Je suis √©quilibr√©(e)", "Je suis plut√¥t radin(e)"],
    theme: 'Argent',
    person: 2
    },
    {
    text: "{prenom1}, √™tes-vous du genre √† √©viter les conflits ?",
    options: ["Oui, toujours", "Oui, souvent", "Non, parfois", "Non, jamais"],
    theme: 'Communication',
    person: 1
    },
    {
    text: "{prenom2}, quel est votre langage d'amour physique pr√©f√©r√© ?",
    options: ["C√¢lins", "Baisers", "Tenir la main", "Massages"],
    theme: 'Affection',
    person: 2
    },
    {
    text: "{prenom1}, quelle est l'importance du contact physique ?",
    options: ["Essentiel", "Important", "Mod√©r√©", "Peu important"],
    theme: 'Affection',
    person: 1
    },
    {
    text: "{prenom2}, √™tes-vous une personne d√©pensi√®re ?",
    options: ["Oui, tr√®s", "Oui, un peu", "Non, pas vraiment", "Non, pas du tout"],
    theme: 'Argent',
    person: 2
    },
    {
    text: "{prenom1}, quelle est votre saison pr√©f√©r√©e ?",
    options: ["Printemps", "√ât√©", "Automne", "Hiver"],
    theme: 'Lifestyle',
    person: 1
    },
    {
    text: "{prenom2}, √™tes-vous une personne patiente ?",
    options: ["Tr√®s patiente", "Assez patiente", "Peu patiente", "Pas du tout patiente"],
    theme: 'Personnalit√©',
    person: 2
    },
    {
    text: "{prenom1}, quel est votre niveau d'activit√© physique ?",
    options: ["Tr√®s actif(ve)", "Actif(ve)", "Mod√©r√©(e)", "S√©dentaire"],
    theme: 'Lifestyle',
    person: 1
    },
    {
    text: "{prenom2}, aimez-vous les discussions profondes ?",
    options: ["Oui, beaucoup", "Oui, parfois", "Non, rarement", "Non, jamais"],
    theme: 'Communication',
    person: 2
    },
    {
    text: "{prenom1}, quelle est votre priorit√© dans une relation ?",
    options: ["L'attraction physique", "La communication", "La s√©curit√© financi√®re", "La relation sexuelle"],
    theme: 'Valeurs',
    person: 1
    },
    {
    text: "{prenom2}, √™tes-vous √† l'aise avec l'id√©e d'avoir des enfants ?",
    options: ["Oui, beaucoup", "Oui, quelques-uns", "Peut-√™tre un", "Non, aucun"],
    theme: 'Avenir',
    person: 2
    },
    {
    text: "{prenom1}, quelle est votre attitude face aux manifestations et aux mouvements sociaux ?",
    options: ["Soutien actif", "Int√©r√™t passif", "Indiff√©rence", "Opposition"],
    theme: 'Valeurs',
    person: 1
    },
    {
    text: "{prenom2}, √™tes-vous √† l'aise avec l'id√©e de parler de vos ex ?",
    options: ["Oui, sans probl√®me", "Oui, mais avec parcimonie", "Non, difficilement", "Non, jamais"],
    theme: 'Communication',
    person: 2
    },
    {
    text: "{prenom1}, quel type de vacances pr√©f√©rez-vous ?",
    options: ["D√©tente √† la plage", "Aventure en montagne", "Visite culturelle", "Voyage humanitaire"],
    theme: 'Lifestyle',
    person: 1
    },
    {
    text: "{prenom2}, √™tes-vous une personne qui aime les c√¢lins ?",
    options: ["Oui, beaucoup", "Oui, de temps en temps", "Non, rarement", "Non, pas du tout"],
    theme: 'Affection',
    person: 2
    },
    {
    text: "{prenom1}, quelle est votre d√©finition de la fid√©lit√© ?",
    options: ["Ne pas tromper physiquement", "√ätre honn√™te et transparent", "Soutenir l'autre dans ses projets", "√ätre toujours pr√©sent(e)"],
    theme: 'Valeurs',
    person: 1
    },
    {
    text: "{prenom2}, comment r√©agissez-vous face √† un d√©saccord ?",
    options: ["Je me f√¢che et je me dispute", "J'essaie de comprendre le point de vue de l'autre", "J'√©vite le conflit", "Je reste calme et je cherche une solution"],
    theme: 'Communication',
    person: 2
    },
    {
    text: "{prenom1}, quelle est votre consommation d'alcool ?",
    options: ["Quotidienne", "Occasionnelle", "Rare", "Jamais"],
    theme: 'Lifestyle',
    person: 1
    },
    {
    text: "{prenom2}, quelle est votre vision du mariage ?",
    options: ["Une institution d√©mod√©e", "Un engagement sacr√©", "Une option √† consid√©rer", "Une source de s√©curit√©"],
    theme: 'Avenir',
    person: 2
    },
    {
    text: "{prenom1}, quel type de cadeau pr√©f√©rez-vous recevoir ?",
    options: ["Quelque chose d'utile", "Quelque chose de sentimental", "Quelque chose de luxueux", "Une exp√©rience"],
    theme: 'Affection',
    person: 1
    },
    {
    text: "{prenom2}, comment exprimez-vous votre amour ?",
    options: ["Par des cadeaux", "Par des mots doux", "Par des actes de service", "Par le contact physique"],
    theme: 'Affection',
    person: 2
    },
    {
    text: "{prenom1}, quel est votre niveau de stress ?",
    options: ["Tr√®s √©lev√©", "√âlev√©", "Mod√©r√©", "Faible"],
    theme: 'Personnalit√©',
    person: 1
    },
    {
    text: "{prenom2}, quelle est votre d√©finition d'une nuit parfaite ?",
    options: ["Romantique", "Aventureuse", "Relaxante", "Passionn√©e"],
    theme: 'Intimit√©',
    person: 2
    },
    {
    text: "{prenom1}, quelle est votre plus grande peur ?",
    options: ["La solitude", "L'√©chec", "La mort", "L'abandon"],
    theme: 'Personnalit√©',
    person: 1
    },
    {
    text: "{prenom2}, quel type de divertissement pr√©f√©rez-vous ?",
    options: ["Sorties culturelles (th√©√¢tre, mus√©e)", "√âv√©nements sportifs", "Concerts", "Soir√©es entre amis en bo√Æte"],
    theme: 'Lifestyle',
    person: 2
    },
    {
    text: "{prenom1}, comment g√©rez-vous les t√¢ches m√©nag√®res ?",
    options: ["Je les fais r√©guli√®rement", "Je les remets √† plus tard", "Je les partage √©quitablement", "Je les d√©l√®gue"],
    theme: 'Lifestyle',
    person: 1
    },
    {
    text: "{prenom2}, est-ce que l'amiti√© homme-femme existe-t-il pour vous ?",
    options: ["Oui, absolument", "Oui, mais c'est compliqu√©", "Non, pas vraiment", "Non, impossible"],
    theme: 'Valeurs',
    person: 2
    },
    {
    text: "{prenom1}, quel est votre style de communication ?",
    options: ["Direct et honn√™te", "Diplomate et attentionn√©", "Passif et √©vitant", "Agressif et dominant"],
    theme: 'Communication',
    person: 1
    },
    {
    text: "{prenom2}, que pensez-vous de l'importance de la famille ?",
    options: ["Essentielle", "Importante", "Relative", "Sans importance"],
    theme: 'Valeurs',
    person: 2
    },
    {
    text: "{prenom1}, avez-vous d√©j√† r√©alis√© un de vos fantasmes ?",
    options: ["Oui", "Non"],
    theme: 'Intimit√© Avanc√©e',
    person: 1
    },
    {
    text: "{prenom2}, que pensez-vous de l'importance de l'argent ?",
    options: ["Essentielle", "Importante", "Relative", "Sans importance"],
    theme: 'Argent',
    person: 2
    },
    {
    text: "{prenom1}, qu'est-ce qui vous attire le plus chez une personne (physiquement) ?",
    options: ["Yeux", "Corps", "Cheveux", "Sourire"],
    theme: 'Attraction',
    person: 1
    },
    {
    text: "{prenom2}, que pensez-vous de l'importance de la sant√© ?",
    options: ["Essentielle", "Importante", "Relative", "Sans importance"],
    theme: 'Lifestyle',
    person: 2
    },
    {
    text: "{prenom1}, aimez-vous prendre les devants ?",
    options: ["Oui", "Non"],
    theme: 'Personnalit√©',
    person: 1
    },
    {
    text: "{prenom2}, comment pr√©f√©rez-vous passer vos soir√©es ?",
    options: ["Sortir avec des amis", "Regarder la t√©l√©vision", "Lire un livre", "Faire du sport"],
    theme: 'Lifestyle',
    person: 2
    },
    {
    text: "{prenom1}, √™tes-vous int√©ress√©(e) par les jeux de r√¥le ?",
    options: ["Oui", "Non", "Peut-√™tre"],
    theme: 'Intimit√© Avanc√©e',
    person: 1
    },
    {
    text: "{prenom2}, comment pr√©f√©rez-vous passer vos vacances ?",
    options: ["√Ä la plage", "√Ä la montagne", "En ville", "√Ä la campagne"],
    theme: 'Lifestyle',
    person: 2
    },
    {
    text: "{prenom1}, aimez-vous les gestes romantiques ?",
    options: ["Oui", "Non"],
    theme: 'Affection',
    person: 1
    },
    {
    text: "{prenom2}, quel est votre endroit pr√©f√©r√© pour faire l'amour (en dehors de la chambre) ?",
    options: ["Plage", "Voiture", "Douche", "Je pr√©f√®re ne pas r√©pondre"],
    theme: 'Intimit√© Avanc√©e',
    person: 2
    },
    {
    text: "{prenom1}, pr√©f√©rez-vous les pr√©liminaires longs ?",
    options: ["Oui", "Non", "√áa d√©pend"],
    theme: 'Intimit√© Avanc√©e',
    person: 1
    },
    {
    text: "{prenom2}, √™tes-vous √† l'aise avec les sextoys ?",
    options: ["Oui", "Non", "Peut-√™tre"],
    theme: 'Intimit√© Avanc√©e',
    person: 2
    },
    {
    text: "{prenom1}, aimez-vous parler pendant l'intimit√© ?",
    options: ["Oui", "Non", "√áa d√©pend"],
    theme: 'Intimit√© Avanc√©e',
    person: 1
    },
    {
    text: "{prenom2}, comment r√©agissez-vous face √† la critique ?",
    options: ["Je me vexe", "J'essaie de m'am√©liorer", "Je l'ignore", "Je me d√©fends"],
    theme: 'Personnalit√©',
    person: 2
    },
    {
    text: "{prenom1}, avez-vous des fantasmes inavouables ?",
    options: ["Oui", "Non"],
    theme: 'Intimit√© Avanc√©e',
    person: 1
    },
    {
    text: "{prenom2}, qu'est-ce qui vous excite le plus qu'on vous dise ?",
    options: ["Compliments sur votre corps", "Mots doux", "Expressions de d√©sir", "Des insultes"],
    theme: 'Intimit√© Avanc√©e',
    person: 2
    },
    {
    text: "{prenom1}, croyez-vous √† l'astrologie ?",
    options: ["Oui", "Non"],
    theme: 'Astrologie',
    person: 1
    },
    {
    text: "{prenom2}, vous int√©ressez-vous √† la politique ?",
    options: ["Oui", "Non"],
    theme: 'Valeurs',
    person: 2
    },
    {
    text: "{prenom1}, vous consid√©rez-vous comme...",
    options: ["De gauche", "De droite", "Du centre", "Apolitique"],
    theme: 'Valeurs',
    person: 1
    },
    {
    text: "{prenom2}, √† quelle fr√©quence avez-vous besoin de solitude ?",
    options: ["Tous les jours", "Plusieurs fois par semaine", "Une fois par semaine", "Rarement"],
    theme: 'Personnalit√©',
    person: 2
    },
    {
    text: "{prenom1}, quelle est votre plus grande d√©pense plaisir ?",
    options: ["Voyages", "Shopping", "Restaurants", "Divertissements"],
    theme: 'Argent',
    person: 1
    },
    {
    text: "{prenom2}, comment g√©rez-vous les finances en couple ?",
    options: ["Comptes s√©par√©s", "Compte commun", "Les deux", "Chacun g√®re ses d√©penses"],
    theme: 'Argent',
    person: 2
    },
    {
    text: "{prenom1}, comment r√©solvez-vous les d√©saccords ?",
    options: ["Discussion calme", "Compromis", "√âvitement", "Dispute"],
    theme: 'Communication',
    person: 1
    },
    {
    text: "{prenom2}, pr√©f√©rez-vous aborder les probl√®mes :",
    options: ["Imm√©diatement", "Apr√®s r√©flexion", "√áa d√©pend", "Je les √©vite"],
    theme: 'Communication',
    person: 2
    },
    {
    text: "{prenom1}, quels gestes vous font vous sentir aim√©(e) ?",
    options: ["Mots d'encouragement", "Cadeaux", "Temps de qualit√©", "Contact physique"],
    theme: 'Affection',
    person: 1
    },
    {
    text: "{prenom2}, √™tes-vous plut√¥t :",
    options: ["Achats impulsifs", "Planification", "√âquilibr√©(e)", "√âconome"],
    theme: 'Argent',
    person: 2
    },
    {
    text: "{prenom1}, ce qui teste le plus votre patience :",
    options: ["Attendre", "Les gens lents", "L'injustice", "L'impr√©vu"],
    theme: 'Personnalit√©',
    person: 1
    },
    {
    text: "{prenom2}, votre activit√© physique pr√©f√©r√©e est :",
    options: ["Sport intense", "Marche", "Yoga", "Danse"],
    theme: 'Lifestyle',
    person: 2
    },
    {
    text: "{prenom1}, vous pr√©f√©rez les conversations :",
    options: ["L√©g√®res", "Profondes", "Les deux"],
    theme: 'Communication',
    person: 1
    },
    {
    text: "{prenom2}, le plus important dans une relation est :",
    options: ["Confiance", "Communication", "Passion", "Soutien"],
    theme: 'Valeurs',
    person: 2
    },
    {
    text: "{prenom1}, vous recherchez chez un partenaire :",
    options: ["Humour", "Intelligence", "Empathie", "Ambition"],
    theme: 'Attraction',
    person: 1
    },
    {
    text: "{prenom2}, en tant que parent, vous seriez :",
    options: ["Protecteur", "Guide", "Ami", "Exigeant"],
    theme: 'Avenir',
    person: 2
    },
    {
    text: "{prenom1}, les limites importantes dans une relation sont :",
    options: ["Honn√™tet√©", "Respect", "Fid√©lit√©", "Communication"],
    theme: 'Valeurs',
    person: 1
    },
    {
    text: "{prenom2}, la confiance se construit par :",
    options: ["Actions", "Paroles", "Transparence", "Coh√©rence"],
    theme: 'Communication',
    person: 2
    },
    {
    text: "{prenom1}, l'alcool dans votre vie sociale est :",
    options: ["Fr√©quent", "Occasionnel", "Rare", "Absent"],
    theme: 'Lifestyle',
    person: 1
    },
    {
    text: "{prenom2}, vos sources de stress sont :",
    options: ["Travail", "Argent", "Relations", "Sant√©"],
    theme: 'Personnalit√©',
    person: 2
    },
    {
    text: "{prenom1}, vous g√©rez le stress par :",
    options: ["Sport", "Relaxation", "Socialisation", "M√©ditation"],
    theme: 'Personnalit√©',
    person: 1
    },
    {
    text: "{prenom2}, les pr√©liminaires sont :",
    options: ["Essentiels", "Importants", "Optionnels", "Inutiles"],
    theme: 'Intimit√© Avanc√©e',
    person: 2
    },
    {
    text: "{prenom1}, les sujets abord√©s pendant l'intimit√© sont :",
    options: ["D√©sirs", "Fantasmes", "Sentiments", "Rien"],
    theme: 'Intimit√© Avanc√©e',
    person: 1
    },
    {
    text: "{prenom2}, √™tes-vous √† l'aise de partager vos fantasmes ?",
    options: ["Oui", "Non"],
    theme: 'Intimit√© Avanc√©e',
    person: 2
    }
    ];

    let currentQuestion = 0;
    let answers = [];
    let prenoms = ["", ""];
    let compatibilityResults = null;

    function showNamesScreen() {
    document.getElementById('startScreen').classList.remove('active');
    document.getElementById('namesScreen').classList.add('active');
    }

    function startTest() {
    const prenom1 = document.getElementById('prenom1').value.trim();
    const prenom2 = document.getElementById('prenom2').value.trim();
    if (!prenom1 || !prenom2) {
    alert('Veuillez entrer les deux pr√©noms');
    return;
    }
    prenoms[0] = prenom1;
    prenoms[1] = prenom2;
    answers = new Array(questions.length);
    document.getElementById('namesScreen').classList.remove('active');
    document.getElementById('questionCard').classList.add('active');
    showQuestion();
    }

    function showQuestion() {
    if (currentQuestion >= questions.length) {
    // Calculer les r√©sultats et afficher l'√©cran email
    compatibilityResults = calculateCompatibility();
    showEmailScreen();
    return;
    }
    const q = questions[currentQuestion];
    const progress = (currentQuestion / questions.length) * 100;
    document.getElementById('progressFill').style.width = progress + '%';
    let questionText = q.text.replace('{prenom1}', prenoms[0]).replace('{prenom2}', prenoms[1]);
    document.getElementById('questionTitle').textContent = questionText;
    let html = '';
    if (Array.isArray(q.options[0])) {
    // Affichage en deux colonnes pour les signes avec espacement am√©lior√©
    html = '<div class="astrology-grid">';
    for(let col=0;col<2;col++){
    html += '<div>';
    q.options[col].forEach((opt, i) => {
    const idx = col*6+i;
    const isSelected = answers[currentQuestion] === idx;
    html += `<button class="option-btn${isSelected ? ' selected' : ''}" onclick="selectOption(${idx})">${opt}</button>`;
    });
    html += '</div>';
    }
    html += '</div>';
    } else {
    q.options.forEach((opt, i) => {
    const isSelected = answers[currentQuestion] === i;
    html += `<button class="option-btn${isSelected ? ' selected' : ''}" onclick="selectOption(${i})">${opt}</button>`;
    });
    }
    document.getElementById('options').innerHTML = html;
    }

    function selectOption(idx) {
    answers[currentQuestion] = idx;
    setTimeout(() => {
    currentQuestion++;
    showQuestion();
    }, 200);
    }

    function showEmailScreen() {
    document.getElementById('questionCard').classList.remove('active');
    document.getElementById('emailScreen').classList.add('active');
    }

    async function submitEmail() {
    const email = document.getElementById('emailInput').value.trim();
    const emailBtn = document.getElementById('emailBtn');
    const emailMessage = document.getElementById('emailMessage');

    if (!email) {
        emailMessage.innerHTML = '<div class="error-message">Veuillez entrer votre adresse email</div>';
        return;
    }

    // Validation email simple
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(email)) {
        emailMessage.innerHTML = '<div class="error-message">Veuillez entrer une adresse email valide</div>';
        return;
    }

    // D√©sactiver le bouton pendant l'envoi
    emailBtn.disabled = true;
    emailBtn.textContent = 'Envoi en cours...';
    emailMessage.innerHTML = '';

    try {
        // Appel √† l'API Brevo
        const response = await fetch('https://api.brevo.com/v3/contacts', {
            method: 'POST',
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json',
                'api-key': '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'
            },
            body: JSON.stringify({
                email: email,
                listIds: [5],
                attributes: {
                    PRENOM1: prenoms[0],
                    PRENOM2: prenoms[1],
                    SCORE_GLOBAL: compatibilityResults.globalScore,
                    DATE_TEST: new Date().toISOString().split('T')[0]
                }
            })
        });

        if (response.ok || response.status === 400) {
            // 400 peut signifier que le contact existe d√©j√†, ce qui est OK
            emailMessage.innerHTML = '<div class="success-message">‚úÖ Email enregistr√© avec succ√®s !</div>';
            setTimeout(() => {
                showResult();
            }, 1500);
        } else {
            throw new Error('Erreur lors de l\'ajout du contact');
        }

    } catch (error) {
        console.error('Erreur Brevo:', error);
        emailMessage.innerHTML = '<div class="error-message">Une erreur est survenue. Vos r√©sultats s\'affichent quand m√™me !</div>';
        setTimeout(() => {
            showResult();
        }, 2000);
    } finally {
        emailBtn.disabled = false;
        emailBtn.textContent = 'Voir mes r√©sultats üíï';
    }
    }

    function calculateCompatibility() {
    const axesScores = {};
    let totalScore = 0;
    let totalQuestions = 0;
    questions.forEach((q, i) => {
    const axis = themeMap[q.theme] || q.theme;
    if (!axesScores[axis]) axesScores[axis] = [];
    axesScores[axis].push({ answer: answers[i], options: Array.isArray(q.options[0]) ? q.options[0].concat(q.options[1]) : q.options });
    });
    const themeScores = {};
    Object.keys(axesScores).forEach(axis => {
    let axisScore = 0;
    axesScores[axis].forEach(q => {
    if (q.answer !== undefined && q.options.length > 1) {
    axisScore += 1 - Math.abs(0.5 - (q.answer / (q.options.length-1)));
    }
    });
    const percent = axesScores[axis].length ? Math.round((axisScore / axesScores[axis].length) * 100) : 0;
    themeScores[axis] = percent;
    totalScore += axisScore;
    totalQuestions += axesScores[axis].length;
    });
    const globalScore = totalQuestions ? Math.round((totalScore / totalQuestions) * 100) : 0;
    return { globalScore, themeScores };
    }

    function generateAnalysisTexts(globalScore, themeScores) {
    let globalAnalysis = '';
    if (globalScore >= 85) {
    globalAnalysis = `üéâ F√©licitations ${prenoms[0]} et ${prenoms[1]} ! Avec ${globalScore}% de compatibilit√©, vous formez un couple exceptionnel. Vos personnalit√©s se compl√®tent parfaitement et vous partagez des valeurs fondamentales similaires. Cette harmonie naturelle est un atout pr√©cieux pour construire une relation durable et √©panouissante.`;
    } else if (globalScore >= 70) {
    globalAnalysis = `‚ú® ${prenoms[0]} et ${prenoms[1]}, votre compatibilit√© de ${globalScore}% r√©v√®le une tr√®s belle harmonie ! Vous avez de solides bases communes tout en conservant vos diff√©rences qui enrichissent votre relation. Quelques ajustements mineurs pourraient encore renforcer votre complicit√©.`;
    } else if (globalScore >= 55) {
    globalAnalysis = `ü§ù Avec ${globalScore}% de compatibilit√©, ${prenoms[0]} et ${prenoms[1]} avez un potentiel int√©ressant. Vos diff√©rences peuvent √™tre source d'enrichissement mutuel si vous apprenez √† les apprivoiser. La communication sera votre meilleur alli√© pour transformer ces diff√©rences en compl√©mentarit√©.`;
    } else if (globalScore >= 40) {
    globalAnalysis = `üí™ ${prenoms[0]} et ${prenoms[1]}, votre score de ${globalScore}% indique des d√©fis √† relever ensemble. Vos personnalit√©s sont assez diff√©rentes, ce qui demande plus d'efforts mais peut aussi cr√©er une dynamique passionnante. L'important est de respecter vos diff√©rences et de trouver des terrains d'entente.`;
    } else {
    globalAnalysis = `üåü ${prenoms[0]} et ${prenoms[1]}, avec ${globalScore}% de compatibilit√©, vous √™tes dans une configuration "oppos√©s qui s'attirent". Vos diff√©rences marqu√©es peuvent soit cr√©er une alchimie unique, soit g√©n√©rer des tensions. Tout d√©pendra de votre capacit√© √† vous comprendre et vous accepter mutuellement.`;
    }
    return { globalAnalysis };
    }

    function generateThemeAnalysis(axis, score) {
    const analyses = {
    'Communication': {
    high: `Votre complicit√© √©motionnelle et votre communication sont naturelles. Vous savez vous √©couter, vous comprendre et exprimer vos sentiments sans effort.`,
    medium: `Votre communication et vos marques d'affection sont globalement compatibles, mais quelques ajustements pourraient renforcer votre lien.`,
    low: `Des efforts seront n√©cessaires pour mieux vous comprendre et exprimer vos besoins affectifs. La patience et l'√©coute seront vos alli√©es.`
    },
    'Intimit√©': {
    high: `Votre vie intime est harmonieuse et vos d√©sirs sont en phase. Vous partagez une belle complicit√© physique et √©motionnelle.`,
    medium: `Vous avez des attentes proches mais quelques diff√©rences √† explorer ensemble pour plus d'√©panouissement.`,
    low: `Vos besoins intimes sont diff√©rents. Le dialogue et l'ouverture d'esprit seront essentiels pour trouver un √©quilibre.`
    },
    'Valeurs': {
    high: `Vos valeurs et vos projets de vie sont align√©s. Vous avancez dans la m√™me direction, ce qui renforce la stabilit√© de votre couple.`,
    medium: `Vous partagez l'essentiel de vos valeurs, mais certains projets ou principes diff√®rent. Le respect mutuel sera la cl√©.`,
    low: `Vos visions de la vie et vos priorit√©s sont tr√®s diff√©rentes. Il faudra beaucoup de dialogue pour construire un projet commun.`
    },
    'Lifestyle': {
    high: `Vos modes de vie et vos temp√©raments s'accordent parfaitement. Vous partagez le m√™me rythme et la m√™me √©nergie.`,
    medium: `Quelques diff√©rences de style de vie ou de caract√®re, mais rien d'insurmontable avec de la compr√©hension.`,
    low: `Vos habitudes et personnalit√©s sont tr√®s contrast√©es. Trouver un terrain d'entente sera un vrai d√©fi.`
    },
    'Argent': {
    high: `Vous avez la m√™me vision de la gestion financi√®re et des priorit√©s mat√©rielles. Cela facilite la vie √† deux.`,
    medium: `Quelques divergences sur l'argent, mais un dialogue ouvert peut permettre de trouver un √©quilibre.`,
    low: `Vos rapports √† l'argent sont oppos√©s. Il faudra √©tablir des r√®gles claires pour √©viter les tensions.`
    },
    'Astrologie': {
    high: `Vos signes astrologiques et votre rapport √† l'astrologie sont tr√®s compatibles. Vous partagez une sensibilit√© commune √† ces influences.`,
    medium: `Vous avez des approches diff√©rentes de l'astrologie, mais cela peut enrichir vos √©changes.`,
    low: `Vos visions de l'astrologie sont oppos√©es. Respectez ces diff√©rences sans les imposer.`
    }
    };
    const themeData = analyses[axis] || analyses['Valeurs'];
    if (score >= 70) return themeData.high;
    else if (score >= 40) return themeData.medium;
    else return themeData.low;
    }

    function showResult() {
    document.getElementById('emailScreen').classList.remove('active');
    document.getElementById('resultCard').classList.add('active');

    const { globalScore, themeScores } = compatibilityResults;
    const { globalAnalysis } = generateAnalysisTexts(globalScore, themeScores);
    document.getElementById('resultScore').textContent = globalScore + '%';
    document.getElementById('globalAnalysis').textContent = globalAnalysis;

    // Graphique global (donut) - TAILLE FIXE ET CONTR√îL√âE
    const ctx1 = document.getElementById('globalChart').getContext('2d');
    new Chart(ctx1, {
    type: 'doughnut',
    data: {
    labels: ['Compatible', 'Diff√©rences'],
    datasets: [{
    data: [globalScore, 100 - globalScore],
    backgroundColor: ['#ff3576', '#333'],
    borderWidth: 0
    }]
    },
    options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
    legend: {
    labels: { 
    color: '#fff',
    font: { family: 'Montserrat', size: 11 }
    }
    }
    }
    }
    });

    // Graphique par axes (barres) - TAILLE FIXE ET CONTR√îL√âE
    const themeNames = axes;
    const themeValues = themeNames.map(ax => themeScores[ax] || 0);
    const ctx2 = document.getElementById('themesChart').getContext('2d');
    new Chart(ctx2, {
    type: 'bar',
    data: {
    labels: themeNames,
    datasets: [{
    label: 'Compatibilit√© (%)',
    data: themeValues,
    backgroundColor: '#ff3576',
    borderRadius: 5
    }]
    },
    options: {
    responsive: true,
    maintainAspectRatio: false,
    indexAxis: 'y',
    scales: {
    x: {
    beginAtZero: true,
    max: 100,
    ticks: { 
    color: '#fff',
    font: { family: 'Montserrat', size: 10 }
    },
    grid: { color: 'rgba(255,255,255,0.1)' }
    },
    y: {
    ticks: { 
    color: '#fff',
    font: { family: 'Montserrat', size: 10 },
    maxRotation: 0
    },
    grid: { color: 'rgba(255,255,255,0.1)' }
    }
    },
    plugins: {
    legend: { display: false },
    tooltip: {
    callbacks: {
    title: function(context) {
    const shortName = context[0].label;
    return axesFullNames[shortName] || shortName;
    }
    }
    }
    }
    }
    });

    // Analyses par axe - UTILISE LES NOMS COMPLETS
    let themeAnalysisHtml = '';
    axes.forEach(axis => {
    const score = themeScores[axis] || 0;
    const fullName = axesFullNames[axis] || axis;
    const analysis = generateThemeAnalysis(axis, score);
    let emoji = '';
    if (score >= 70) emoji = 'üíö';
    else if (score >= 40) emoji = 'üíõ';
    else emoji = '‚ù§Ô∏è';
    themeAnalysisHtml += `
    <div class="theme-card">
    <div class="theme-name">${emoji} ${fullName}</div>
    <div class="theme-score">${score}%</div>
    <div class="theme-text">${analysis}</div>
    </div>
    `;
    });
    document.getElementById('themeAnalysis').innerHTML = themeAnalysisHtml;
    }
  </script>
</body>
</html>